<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Meta Tag -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Daily Blueprint</title>
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- Tailwind CSS -->
    <link href="./dist/css/output.css" rel="stylesheet" />
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
    <!-- Theme Controller & Component Loader -->
    <script src="./assets/js/theme-controller.js"></script>
    <!-- Alpine.js for component loading -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.15.2/dist/cdn.min.js"></script>
</head>

<body class="min-h-screen" x-data="{...themeController(), basePath: '.', activePage: 'home'}" x-init="initTheme()">
    <div data-component="navbar.html" data-base-path="." class="sticky top-0 z-50"></div>
    
    <main class="flex-1">
        <div data-component="hero.html" data-base-path=".."></div>
        <div data-component="feature.html" data-base-path=".."></div>
        <div data-component="tutorial.html" data-base-path=".."></div>
        <div data-component="cta.html" data-base-path=".."></div>
    </main>

    <div data-component="footer-home.html" data-base-path="."></div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
      // Get DaisyUI theme colors by reading from styled elements
      function getDaisyUIColors() {
        const tempEl = document.createElement('div');
        tempEl.style.display = 'none';
        document.body.appendChild(tempEl);
        
        const colorMap = {
          success: 'bg-success',
          warning: 'bg-warning', 
          error: 'bg-error'
        };
        
        const colors = {};
        for (const [key, className] of Object.entries(colorMap)) {
          tempEl.className = className;
          colors[key] = getComputedStyle(tempEl).backgroundColor;
        }
        
        document.body.removeChild(tempEl);
        return colors;
      }

      let weeklyChart = null;

      // Wait for components to load, then initialize chart
      function initWeeklyChart() {
        const canvas = document.getElementById('weeklyChart');
        if (canvas) {
          const colors = getDaisyUIColors();
          const ctx = canvas.getContext('2d');
          weeklyChart = new Chart(ctx, {
            type: 'pie',
            data: {
              labels: ['Completed', 'In Progress', 'Missed'],
              datasets: [{
                data: [65, 20, 15],
                backgroundColor: [colors.success, colors.warning, colors.error],
                borderWidth: 0
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: {
                  display: true,
                  position: 'right',
                  labels: {
                    boxWidth: 12,
                    font: { size: 10 }
                  }
                }
              }
            }
          });
        } else {
          // Retry after components load
          setTimeout(initWeeklyChart, 100);
        }
      }

      // Update chart colors when theme changes
      function updateChartColors() {
        if (weeklyChart) {
          const colors = getDaisyUIColors();
          weeklyChart.data.datasets[0].backgroundColor = [colors.success, colors.warning, colors.error];
          weeklyChart.update();
        }
      }

      // Watch for theme changes
      const observer = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
          if (mutation.attributeName === 'data-theme') {
            // Small delay to let CSS variables update
            setTimeout(updateChartColors, 50);
          }
        });
      });

      document.addEventListener('DOMContentLoaded', () => {
        initWeeklyChart();
        observer.observe(document.documentElement, { attributes: true });
      });
    </script>
</body>

</html>